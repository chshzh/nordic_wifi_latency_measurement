#
# Configuration overlay for UDP RX Device - Test 2
# RX device acts as SoftAP and receives UDP packets
# This device receives UDP packets and triggers LED2 GPIO
#

# Device role and test mode
CONFIG_WIFI_UDP_PACKET_LATENCY_DEVICE_ROLE_RX=y
CONFIG_WIFI_UDP_PACKET_LATENCY_TEST_MODE_SOFTAP=y

#CONFIG_WIFI_CREDENTIALS_STATIC_SSID="YourWiFiSSID"
#CONFIG_WIFI_CREDENTIALS_STATIC_PASSWORD="YourPASSWORD"
CONFIG_WIFI_CREDENTIALS_STATIC_SSID="TP-Matter"
CONFIG_WIFI_CREDENTIALS_STATIC_PASSWORD="BillionMatter2025"
# SoftAP configuration
# CONFIG_WIFI_UDP_PACKET_LATENCY_SOFTAP_SSID="wifi-latency-test"
# CONFIG_WIFI_UDP_PACKET_LATENCY_SOFTAP_PSK="testpass123"

# Test parameters
CONFIG_WIFI_UDP_PACKET_LATENCY_UDP_PORT=12345

# Enable AP mode support
CONFIG_NRF70_AP_MODE=y
CONFIG_WIFI_NM_WPA_SUPPLICANT_AP=y

# Enable Wi-Fi ready library for proper initialization
CONFIG_WIFI_READY_LIB=y

# DHCP server for SoftAP clients (standard Zephyr config)
CONFIG_NET_DHCPV4_SERVER=y

# CRITICAL: WPA supplicant thread stack size for SoftAP mode
# This prevents stack overflow in wpa_supplicant threads
CONFIG_WIFI_NM_WPA_SUPPLICANT_THREAD_STACK_SIZE=8192


# Nordic-specific Wi-Fi work queue stack sizes
CONFIG_NRF70_IRQ_WQ_STACK_SIZE=1024
CONFIG_NRF70_BH_WQ_STACK_SIZE=2300

# Network management event stack size
CONFIG_NET_MGMT_EVENT_STACK_SIZE=4096

# Optimize stack sizes based on Nordic SoftAP sample
CONFIG_MAIN_STACK_SIZE=5200
CONFIG_NET_RX_STACK_SIZE=4096
CONFIG_NET_TX_STACK_SIZE=4096
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=4096

# Enhanced connectivity timeout for reliable connection
CONFIG_NET_SOCKETS_CONNECT_TIMEOUT=60000

# LED GPIO optimization for precise timing measurements  
CONFIG_GPIO=y

# Network configuration for AP mode
CONFIG_NET_CONFIG_MY_IPV4_ADDR="192.168.1.1"
CONFIG_NET_CONFIG_MY_IPV4_NETMASK="255.255.255.0"
CONFIG_NET_CONFIG_MY_IPV4_GW="192.168.1.1"

# Network optimization for AP mode (from Nordic SoftAP sample)
CONFIG_NET_PKT_RX_COUNT=8
CONFIG_NET_PKT_TX_COUNT=8
CONFIG_NET_BUF_RX_COUNT=8
CONFIG_NET_BUF_TX_COUNT=16
CONFIG_NRF70_RX_NUM_BUFS=16
CONFIG_NRF70_MAX_TX_AGGREGATION=4
CONFIG_NRF_WIFI_CTRL_HEAP_SIZE=20000
CONFIG_NRF_WIFI_DATA_HEAP_SIZE=53000

# Network settings from Nordic SoftAP sample
CONFIG_NET_MAX_CONTEXTS=5
CONFIG_NET_CONTEXT_SYNC_RECV=y
CONFIG_NET_SOCKETS_POLL_MAX=10
CONFIG_NET_CONFIG_SETTINGS=y
CONFIG_NET_CONFIG_INIT_TIMEOUT=0

# Network management timeout (from Nordic sample)
CONFIG_NET_MGMT_EVENT_QUEUE_TIMEOUT=5000

# Kernel options
CONFIG_ENTROPY_GENERATOR=y

# Enable file system (from Nordic sample)
CONFIG_FILE_SYSTEM=y

CONFIG_WIFI_SOFTAP_REG_DOMAIN="00"